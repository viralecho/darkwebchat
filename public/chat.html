<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BlackCircuit Chat</title>
  <style>
    body { background:#000; color:#0f0; font-family:monospace; margin:0; display:flex; flex-direction:column; height:100vh; }
    #chat { flex:1; padding:1rem; overflow-y:auto; white-space:pre-wrap; }
    form { display:flex; border-top:1px solid #0f0; }
    input { flex:1; background:#000; color:#0f0; border:none; padding:.5rem; }
    button { background:#111; color:#0f0; border:none; padding:0 .75rem; cursor:pointer; }
    button:hover { background:#222; }
  </style>
</head>
<body>
  <div id="chat"></div>
  <form id="f">
    <input id="m" autocomplete="off" placeholder="Type a messageâ€¦" />
    <button>Send</button>
  </form>
  <script>
    const chatDiv = document.getElementById('chat');
    async function fetchMsgs() {
      let res = await fetch('/chat');               // GET redirects to our Function
      let lines = await res.json();
      chatDiv.textContent = lines.join('\n');
      chatDiv.scrollTop = chatDiv.scrollHeight;
    }
    document.getElementById('f').addEventListener('submit', async e => {
      e.preventDefault();
      let txt = document.getElementById('m').value.trim();
      if (!txt) return;
      await fetch('/chat', {
        method: 'POST',
        body: JSON.stringify({ message: txt }),
      });
      document.getElementById('m').value = '';
      fetchMsgs();
    });
    setInterval(fetchMsgs, 2000);
    fetchMsgs();
  </script>
</body>
</html>
